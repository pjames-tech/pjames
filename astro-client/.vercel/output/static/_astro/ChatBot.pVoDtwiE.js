import{d as te,c as i,a as se,g as _,b as W,i as m,e as D,f as v,r as ae,u as ne,t as $,h as w,s as re,j as S,F as ie,S as oe}from"./web.PHWK_1bi.js";var le=$('<div class="bg-white/10 text-[rgb(161_161_170)] max-w-[85%] rounded-2xl px-4 py-2 text-sm"><span class=animate-pulse>Thinking...'),de=$('<div class="rounded-[1.25rem] bg-[rgb(17_19_24/0.72)] backdrop-blur-md border border-white/10 p-[var(--space-3)] flex flex-col h-[400px]"><div class="flex items-center justify-between mb-4"><div><h3 class="font-display font-bold text-lg">ARCHIBOT</h3><p class="text-xs text-[rgb(161_161_170)]">Assistant</p></div><div class="flex gap-1"><button>Lead Capture</button><button>AI Chat</button><span class="px-2 py-1 text-xs rounded-full bg-green-500/20 text-green-400">Ready</span></div></div><p class="text-xs text-[rgb(161_161_170)] mb-3"></p><div class="flex-1 overflow-y-auto space-y-3 mb-4 pr-2"><!$><!/><!$><!/></div><form class="flex gap-2"><input type=text class="flex-1 rounded-full bg-[rgb(10_11_14/0.5)] border border-white/10 px-4 py-2 text-sm outline-none focus:border-[rgb(191_87_0/0.5)] disabled:opacity-50"><button type=submit class="px-4 py-2 rounded-full bg-[rgb(191_87_0)] text-[rgb(10_11_14)] font-medium text-sm hover:brightness-110 transition disabled:opacity-50">Send'),ce=$("<div>");const d=[{key:"name",text:"What's your name?",placeholder:"Your name"},{key:"email",text:"Great! What's your email so I can send you info?",placeholder:"you@company.com"},{key:"business",text:"What's your business or niche?",placeholder:"e.g. Real Estate, Coaching"},{key:"goal",text:"What's the #1 thing you want to achieve in the next 30-60 days?",placeholder:"e.g. Get more leads"},{key:"budget",text:"Do you have a budget range in mind?",placeholder:"e.g. $1,500-$2,500"},{key:"timeline",text:"When do you need this done?",placeholder:"e.g. ASAP, Next month"}];function he(){const[c,J]=i("lead"),[x,C]=i([{role:"assistant",text:"Hey! ðŸ‘‹ I'm ARCHIBOT. Click 'AI Chat' to ask me about services, or answer a few quick questions in Lead Capture mode so P. James can review your project."}]),[f,k]=i(""),[b,p]=i(!1),[y,A]=i(0),[B,I]=i({}),[T,Y]=i(!1);let u;se(()=>{x(),u&&(u.scrollTop=u.scrollHeight)});const n=(a,e)=>{C(s=>[...s,{role:a,text:e}])},L=a=>{J(a),C([]),A(0),I({}),a==="lead"?n("assistant",d[0].text):n("assistant","AI Mode. Ask me about branding or automation.")},F=async a=>{a.preventDefault();const e=f().trim();!e||b()||(n("user",e),k(""),c()==="lead"?await G(e):await Q(e))},G=async a=>{const e=y(),s=d[e];if(I(r=>({...r,[s.key]:a})),e<d.length-1)A(e+1),setTimeout(()=>{n("assistant",d[e+1].text)},500);else{p(!0);const r={...B(),[s.key]:a};try{(await fetch("/api/lead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:"archibot-lead",answers:r,meta:{ts:new Date().toISOString()}})})).ok?(n("assistant","Thanks! ðŸš€ Your brief has been sent to P. James. He'll reach out within 24 hours. In the meantime, feel free to switch to AI Chat to ask any questions!"),Y(!0)):n("assistant","Hmm, something went wrong. Try refreshing or email pjames1643@gmail.com directly.")}catch{n("assistant","Couldn't send. Email pjames1643@gmail.com directly.")}finally{p(!1)}}},Q=async a=>{p(!0);const e=x().slice(-10).map(s=>({role:s.role,content:s.text}));e.push({role:"user",content:a});try{const s=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})});if(s.ok){const r=await s.json();n("assistant",r.text||"I didn't get a response. Try again?")}else s.status===501?n("assistant","AI chat isn't configured on this server. Switch to Lead Capture to submit your project details."):s.status===429?n("assistant","You've sent a lot of messages! Take a breather and try again in a few minutes."):n("assistant","AI Server is offline. Switch to Lead Capture?")}catch{n("assistant","Couldn't reach AI. Switch to Lead Capture to submit your details.")}finally{p(!1)}},U=()=>c()==="lead"&&y()<d.length?d[y()].placeholder:"Type...";return(()=>{var a=_(de),e=a.firstChild,s=e.firstChild,r=s.nextSibling,h=r.firstChild,E=h.nextSibling,j=e.nextSibling,o=j.nextSibling,z=o.firstChild,[O,K]=W(z.nextSibling),V=O.nextSibling,[X,Z]=W(V.nextSibling),H=o.nextSibling,g=H.firstChild,ee=g.nextSibling;h.$$click=()=>L("lead"),E.$$click=()=>L("ai"),m(j,()=>c()==="ai"?"AI Mode. Ask me about branding or automation.":"Lead Capture. Answer a few quick questions.");var N=u;return typeof N=="function"?ne(N,o):u=o,m(o,D(ie,{get each(){return x()},children:t=>(()=>{var l=_(ce);return m(l,()=>t.text),v(()=>w(l,`max-w-[85%] rounded-2xl px-4 py-2 text-sm ${t.role==="user"?"ml-auto bg-[rgb(191_87_0)] text-white":"bg-white/10 text-[rgb(244_244_245)]"}`)),l})()}),O,K),m(o,D(oe,{get when(){return b()},get children(){return _(le)}}),X,Z),H.addEventListener("submit",F),g.$$input=t=>k(t.currentTarget.value),v(t=>{var l=`px-3 py-1 text-xs rounded-full transition ${c()==="lead"?"bg-[rgb(191_87_0/0.2)] text-[rgb(191_87_0)] border border-[rgb(191_87_0/0.3)]":"bg-white/5 text-[rgb(161_161_170)] hover:bg-white/10"}`,P=`px-3 py-1 text-xs rounded-full transition ${c()==="ai"?"bg-[rgb(191_87_0/0.2)] text-[rgb(191_87_0)] border border-[rgb(191_87_0/0.3)]":"bg-white/5 text-[rgb(161_161_170)] hover:bg-white/10"}`,R=U(),q=b()||T(),M=b()||!f().trim()||T();return l!==t.e&&w(h,t.e=l),P!==t.t&&w(E,t.t=P),R!==t.a&&re(g,"placeholder",t.a=R),q!==t.o&&S(g,"disabled",t.o=q),M!==t.i&&S(ee,"disabled",t.i=M),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),v(()=>S(g,"value",f())),ae(),a})()}te(["click","input"]);export{he as default};
