---
// BackToTop button - shows on scroll, smooth scrolls to top
---

<button
  id="back-to-top"
  class="fixed bottom-4 right-4 z-50 h-12 w-12 flex items-center justify-center rounded-full bg-zinc-800 border border-zinc-700 text-zinc-300 hover:bg-zinc-700 hover:text-white shadow-lg hover:scale-110 transition-all duration-300 opacity-0 pointer-events-none"
  aria-label="Back to top"
>
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2.5"
  >
    <path d="M18 15l-6-6-6 6" />
  </svg>
</button>

<script>
  const initBackToTop = () => {
    const btn = document.getElementById("back-to-top");
    if (!btn) return;

    const handleScroll = () => {
      const isVisible = window.scrollY > window.innerHeight * 0.5;
      btn.classList.toggle("opacity-0", !isVisible);
      btn.classList.toggle("pointer-events-none", !isVisible);
    };

    btn.addEventListener("click", () => {
      if ((window as any).lenis) {
        (window as any).lenis.scrollTo(0, { duration: 1.5, easing: (t: number) => Math.min(1, 1.001 - Math.pow(2, -10 * t)) });
      } else {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    });

    window.addEventListener("scroll", handleScroll, { passive: true });
    handleScroll();
  };

  document.addEventListener("DOMContentLoaded", initBackToTop);
  document.addEventListener("astro:page-load", initBackToTop);
</script>
